

===== LIZMAP CONFIG: localconfig.ini.php =====

+ cat /var/www/lizmap-web-client-3.9.1/lizmap/var/config/localconfig.ini.php
;<?php exit(''); ?>
;for security reasons , don't remove or modify the first line

; put here configuration variables that are specific to this installation


; chmod for files created by Lizmap and Jelix
;chmodFile=0664
;chmodDir=0775
                                                                           


[modules]
;; uncomment it if you want to use ldap for authentication
;; see documentation to complete the ldap configuration
;ldapdao.enable=on

[qgisWrapper]
enabled=off
; If off, FCGI is not allowed, only Py-QGIS-Server or QJazz
; https://docs.lizmap.com/current/en/install/py-qgis-server.html
; https://docs.3liz.org/py-qgis-server/
; https://github.com/3liz/qjazz
; allowFcgi=off

[coordplugin_auth]
;; uncomment it if you want to use ldap for authentication
;; see documentation to complete the ldap configuration
;driver=ldapdao


[mailer]
;; to send email via SMTP, uncomment this line, and fill the section smtp:mailer into profiles.ini.php
;mailerType=smtp


[auth_db]
; uncomment to enable authentication with the login or the email
;authenticateWith=login-email

[coordplugins]
lizmap=lizmapConfig.ini.php

[services]
qgisServerVersion=3.34
wmsServerURL="http://127.0.0.1:8080/cgi-bin/qgis_mapserv.fcgi"
ignoreQgisServerWrapper=on

exit_code=0


===== LIZMAP CONFIG: lizmapConfig.ini.php =====

+ cat /var/www/lizmap-web-client-3.9.1/lizmap/var/config/lizmapConfig.ini.php
;<?php exit(''); ?>
;for security reasons , don't remove or modify the previous line

;Services
;list the different map services (servers, generic parameters, etc.)
[services]
;URL to QGIS Server for OGC web services
wmsServerURL="http://127.0.0.1:8080/cgi-bin/qgis_mapserv.fcgi"
;WMS subdomain URLs list (optional)
wmsPublicUrlList=
;URL to the API exposed by the Lizmap plugin for QGIS Server if needed
lizmapPluginAPIURL=

onlyMaps=0
defaultRepository=
defaultProject=

; cache configuration for tiles
cacheStorageType=file
;cacheStorageType=sqlite => store cached images in one sqlite file per repo/project/layer
;cacheStorageType=file => store cached images in one folder per repo/project/layer. The root folder is /tmp/
;cacheStorageType=redis => store cached images through redis
cacheRedisHost=localhost
cacheRedisPort=6379
cacheRedisDb=
cacheRedisKeyPrefix=

; default cache expiration : the default time to live of data, in seconds.
; 0 means no expiration, max : 2592000 seconds (30 days)
cacheExpiration=0

; debug mode
; on = print debug messages in lizmap/var/log/messages.log
; off = no lizmap debug messages
debugMode=0
; cache root directory where cache files will be stored
; must be writable
cacheRootDirectory="/tmp/"

; path to find repositories
;rootRepositories="path"

; path to find the QGIS projects private data
; created by Lizmap or other tools, related to Qgis projects
; if empty, rootRepositories is used.
qgisProjectsPrivateDataFolder=

; Does the server use relative path from root folder? 0/1
;relativeWMSPath=0

[repository:wfml]
label="Wimmera Flood"
path="/var/www/qgis/wfml/"
allowUserDefinedThemes=1
accessControlAllowOrigin=
exit_code=0


===== LIZMAP CONFIG: profiles.ini.php =====

+ cat /var/www/lizmap-web-client-3.9.1/lizmap/var/config/profiles.ini.php
;<?php exit(''); ?>
;for security reasons, don't remove or modify the first line

[jdb]

; name of the default profile to use for any connection
default=jauth
jacl2_profile=jauth

[jdb:jauth]
driver=sqlite3
database="var:db/jauth.db"

[jdb:lizlog]
driver=sqlite3
database="var:db/logs.db"

; when you have charset issues, enable force_encoding so the connection will be
; made with the charset indicated in jelix config
;force_encoding = on

; with the following parameter, you can specify a table prefix which will be
; applied to DAOs automatically. For manual jDb requests, please use method
; jDbConnection::prefixTable().
;table_prefix =

; Example for pdo :
;driver=pdo
;dsn=mysql:host=localhost;dbname=test
;user=
;password=


; ldap configuration. See documentation
[ldap:lizmapldap]
hostname=localhost
port=389
adminUserDn="cn=admin,ou=lizmap,dc=com"
adminPassword=""

; base dn to search users. Used to search a user using the filter from searchUserFilter
; example for Active Directory: "ou=ADAM users,o=Microsoft,c=US", or "OU=Town,DC=my-town,DC=com"
searchUserBaseDN="dc=XY,dc=fr"

; filter to get user information, with the given login name
; example for Active Directory: "(sAMAccountName=%%LOGIN%%)"
searchUserFilter="(&(objectClass=posixAccount)(uid=%%LOGIN%%))"
; it can be a list:
;searchUserFilter[]=...
;searchUserFilter[]=...

; the dn to bind the user to login.
; The value can contain a `?` that will be replaced by the corresponding
; attribute value readed from the result of searchUserFilter.
; Or it can contain  `%%LOGIN%%`, replaced by the given login
; Or it can contain only an attribute name, starting with a `$`: the
; attribute should then contain a full DN.
bindUserDN="uid=%?%,ou=users,dc=XY,dc=fr"
;It can be a list of DN template:
;bindUserDN[]= ...
;bindUserDN[]= ...

; attributes to retrieve for a user
; for dao mapping: "ldap attribute:dao attribute"
; ex: "uid:login,givenName:firstname,mail:email" : uid goes into the login property,
; ldap attribute givenName goes to the property firstname etc..
; example for Active Directory: "cn,distinguishedName,name"
; or "sAMAccountName:login,givenName:firstname,sn:lastname,mail:email,distinguishedName,name,dn"
searchAttributes="uid:login,givenName:firstname,sn:lastname,mail:email"

; search ldap filter to retrieve groups of a user.
; The user will be assign to jAcl2 groups having the same name of ldap groups.
; Leave empty if you don't want this synchronisation between jAcl2 groups and
; ldap groups.
; !!! IMPORTANT !!! : if searchGroupFilter is not empty,
; the plugin will remove the user from all existing jelix groups
; and only keep the relation between the user and the group retrieved from LDAP
;searchGroupFilter="(&(objectClass=posixGroup)(cn=XYZ*)(memberUid=%%LOGIN%%))"
searchGroupFilter=

; the property in the ldap entry corresponding to a group, that indicate the
; the group name
searchGroupProperty="cn"

; base dn to search groups. Used to search a group using the filter from searchGroupFilter
searchGroupBaseDN=""


[jcache]

; name of the default profil to use for cache
default=lizmap
; the other jcache could be : qgisprojects, acl2db, tiles, requests

[jcache:lizmap]
; disable or enable cache for this profile
enabled=1
; driver type (file, db, memcached)
driver=file
; TTL used (0 means no expire)
ttl=0


; Automatic cleaning configuration (not necessary with memcached)
;   0 means disabled
;   1 means systematic cache cleaning of expired data (at each set or add call)
;   greater values mean less frequent cleaning
;automatic_cleaning_factor = 0

; Parameters for file driver :

; directory where to put the cache files (optional default 'JELIX_APP_TEMP_PATH/cache/')
cache_dir=
; enable / disable locking file
file_locking=1
; directory level. Set the directory structure level. 0 means "no directory structure", 1 means "one level of directory", 2 means "two levels"...
directory_level=0
; umask for directory structure (default jelix one : 0775)
directory_umask=
; prefix for cache files (default 'jelix_cache')
file_name_prefix=
; umask for cache files (default jelix one: 0664)
cache_file_umask=

; Parameters for db driver :

; dao used (default 'jelix~jcache')
;dao = ""
; dbprofil (optional)
;dbprofile = ""


; Parameters for memcached driver :

; Memcached servers.
; Can be a list e.g
;servers = memcache_host1:11211,memcache_host2:11211,memcache_host3:11211 i.e HOST_NAME:PORT
;servers =

[jcache:qgisprojects]
enabled=1
ttl=0
driver=file

;driver=redis_ext
; docker host
;host=redis
; local host
;host=127.0.0.1
;port=6379
;db=1

;[jcache:acl2db]
;enabled=1
;driver=redis_ext
;host=redis
;port=6379
;db=2
;ttl=0


[jcache:requests]
enabled=1
ttl=0
driver=file

;driver=redis_ext
; docker host
;host=redis
; local host
;host=127.0.0.1
;port=6379
;db=0

[smtp:mailer]
;; to send emails via smtp, uncomment these lines and indicate all needed values.
;; In localconfig.ini, set mailerType=smtp in the [mailer] section.
;host=localhost
;port=25,
;; "" or "ssl" or "tls"
;secure_protocol=
;helo=
;auth_enabled=true
;username=
;password=
;timeout=10

;; Connection profile to webdav server
;; To use remote webdav storage for store files uncomment the following lines
;; This configuration must mirror the 'Attachment widget' settings in the qgis project:
;;
;; baseUri -> must be the root of webdav server (must end with '/')
;; e.g. if the QGIS store url is set as 'http(s)://webdavserver.tld/shapeData/'||file_name(@selected_file_path) baseUri should be 'http(s)://webdavserver.tld/'
;;
;; WARNING: the 'baseUri' will be exposed on the web client
;;
;; user -> same as configured in the Authentication section of External storage configuration (Attachment widget)
;; password -> same as configured in the Authentication section of External storage configuration (Attachment widget)
;;
[webdav:default]
;baseUri=
;enabled=1
;user=
;password=
exit_code=0


===== LIZMAP CONFIG DIST: localconfig.ini.php.dist =====

+ cat /var/www/lizmap-web-client-3.9.1/lizmap/var/config/localconfig.ini.php.dist
;<?php exit(''); ?>
;for security reasons , don't remove or modify the first line

; put here configuration variables that are specific to this installation


; chmod for files created by Lizmap and Jelix
;chmodFile=0664
;chmodDir=0775



[modules]
;; uncomment it if you want to use ldap for authentication
;; see documentation to complete the ldap configuration
;ldapdao.enable=on

[qgisWrapper]
; If off, FCGI is not allowed, only Py-QGIS-Server or QJazz
; https://docs.lizmap.com/current/en/install/py-qgis-server.html
; https://docs.3liz.org/py-qgis-server/
; https://github.com/3liz/qjazz
; allowFcgi=off

[coordplugin_auth]
;; uncomment it if you want to use ldap for authentication
;; see documentation to complete the ldap configuration
;driver=ldapdao


[mailer]
;; to send email via SMTP, uncomment this line, and fill the section smtp:mailer into profiles.ini.php
;mailerType=smtp


[auth_db]
; uncomment to enable authentication with the login or the email
;authenticateWith=login-email
exit_code=0


===== QGIS PROJECT FILES =====

+ ls -la /var/www/qgis/wfml/
total 2484
drwxrwxr-x 5 ubuntu ubuntu    4096 Feb  9 04:07 .
drwxr-xr-x 3 ubuntu ubuntu    4096 Feb  9 04:06 ..
drwxrwxr-x 3 ubuntu ubuntu    4096 Feb  9 03:43 .cursor
drwxrwxr-x 8 ubuntu ubuntu    4096 Feb  9 03:43 .git
-rw-rw-r-- 1 ubuntu ubuntu      12 Feb  9 03:43 .gitignore
-rw-rw-r-- 1 ubuntu ubuntu    2424 Feb  9 03:43 compress_tifs.ps1
drwxrwxr-x 4 ubuntu ubuntu    4096 Feb  9 04:07 data
-rw-rw-r-- 1 ubuntu ubuntu 1200137 Feb  9 03:43 wfml.qgs
-rw-rw-r-- 1 ubuntu ubuntu  100717 Feb  9 03:43 wfml.qgs.cfg
-rw-rw-r-- 1 ubuntu ubuntu 1201370 Feb  9 03:43 wfml.qgs~
-rw-rw-r-- 1 ubuntu ubuntu    2112 Feb  9 03:43 wfml_attachments.zip
exit_code=0

+ ls -la /var/www/qgis/wfml/wfml.qgs*
-rw-rw-r-- 1 ubuntu ubuntu 1200137 Feb  9 03:43 /var/www/qgis/wfml/wfml.qgs
-rw-rw-r-- 1 ubuntu ubuntu  100717 Feb  9 03:43 /var/www/qgis/wfml/wfml.qgs.cfg
-rw-rw-r-- 1 ubuntu ubuntu 1201370 Feb  9 03:43 /var/www/qgis/wfml/wfml.qgs~
exit_code=0

+ stat /var/www/qgis/wfml/wfml.qgs
  File: /var/www/qgis/wfml/wfml.qgs
  Size: 1200137   	Blocks: 2352       IO Block: 4096   regular file
Device: 259,1	Inode: 786498      Links: 1
Access: (0664/-rw-rw-r--)  Uid: ( 1000/  ubuntu)   Gid: ( 1000/  ubuntu)
Access: 2026-02-09 04:14:06.821063426 +0000
Modify: 2026-02-09 03:43:41.475670505 +0000
Change: 2026-02-09 04:06:53.387280072 +0000
 Birth: 2026-02-09 04:06:53.387246899 +0000
exit_code=0


===== QGIS PROJECT PERMISSIONS (www-data readable?) =====

+ sudo -u www-data test -r /var/www/qgis/wfml/wfml.qgs && echo 'READABLE' || echo 'NOT READABLE'
READABLE
exit_code=0

+ sudo -u www-data test -r /var/www/qgis/wfml/wfml.qgs.cfg && echo 'READABLE' || echo 'NOT READABLE'
READABLE
exit_code=0


===== LIZMAP INSTANCES =====

+ ls -la /var/www/lizmap-web-client-3.9.1/lizmap/var/config/
total 56
drwxrwxr-x  3 www-data www-data 4096 Feb  9 04:55 .
drwxrwxr-x 11 www-data www-data 4096 Jun 17  2024 ..
-rwxrwxr-x  1 www-data www-data 2876 Feb  9 04:37 installer.ini.php
-rwxrwxr-x  1 www-data www-data  225 Feb  9 04:37 liveconfig.ini.php
-rwxrwxr-x  1 www-data www-data 1666 Feb  9 04:49 lizmapConfig.ini.php
-rwxrwxr-x  1 www-data www-data 1544 Jul 15  2025 lizmapConfig.ini.php.dist
-rwxrwxr-x  1 www-data www-data  869 Jul 15  2025 lizmapLogConfig.ini.php
-rwxrwxr-x  1 www-data www-data 1182 Feb  9 04:55 localconfig.ini.php
-rwxrwxr-x  1 www-data www-data 1000 Jul 15  2025 localconfig.ini.php.dist
-rwxrwxr-x  1 www-data www-data 5878 Feb  9 04:36 profiles.ini.php
-rwxrwxr-x  1 www-data www-data 5878 Jul 15  2025 profiles.ini.php.dist
drwxrwxr-x  2 www-data www-data 4096 Feb  9 04:37 uninstall
exit_code=0

+ find /var/www/lizmap-web-client-3.9.1/ -name 'repositories.ini.php' -exec cat {} \;
exit_code=0


===== LIZMAP VAR PERMISSIONS =====

+ ls -la /var/www/lizmap-web-client-3.9.1/lizmap/var/
total 44
drwxrwxr-x 11 www-data www-data 4096 Jun 17  2024 .
drwxrwxr-x 12 root     root     4096 Jul 15  2025 ..
drwxrwxr-x  3 www-data www-data 4096 Feb  9 04:55 config
drwxrwxr-x  2 www-data www-data 4096 Feb  9 04:44 db
drwxrwxr-x  2 www-data www-data 4096 Mar 19  2021 lizmap-theme-config
drwxrwxr-x  2 www-data www-data 4096 Feb  9 04:55 log
drwxrwxr-x  2 www-data www-data 4096 Mar 19  2021 mails
drwxrwxr-x  2 www-data www-data 4096 Jun 17  2024 overloads
drwxrwxr-x  2 www-data www-data 4096 Mar 19  2021 sessions
drwxrwxr-x  3 www-data www-data 4096 Feb 29  2020 themes
drwxrwxr-x  2 www-data www-data 4096 Mar 19  2021 uploads
exit_code=0

+ ls -la /var/www/lizmap-web-client-3.9.1/lizmap/var/db/
total 92
drwxrwxr-x  2 www-data www-data  4096 Feb  9 04:44 .
drwxrwxr-x 11 www-data www-data  4096 Jun 17  2024 ..
-rwxrwxr-x  1 www-data www-data     0 Jul 15  2025 .empty
-rwxrwxr-x  1 www-data www-data 65536 Feb  9 04:44 jauth.db
-rwxrwxr-x  1 www-data www-data 20480 Feb  9 04:37 logs.db
exit_code=0

+ ls -la /var/www/lizmap-web-client-3.9.1/lizmap/var/log/
total 8
drwxrwxr-x  2 www-data www-data 4096 Feb  9 04:55 .
drwxrwxr-x 11 www-data www-data 4096 Jun 17  2024 ..
-rwxrwxr-x  1 www-data www-data    0 Jul 15  2025 .empty
exit_code=0


===== APACHE QGIS SERVER CONFIG =====

+ cat /etc/apache2/sites-available/qgis-server.conf
<VirtualHost *:8080>
    ServerName testpozi.online

    ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/
    <Directory "/usr/lib/cgi-bin/">
        AllowOverride None
        Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch
        Require all granted
    </Directory>

    FcgidInitialEnv QGIS_SERVER_LOG_STDERR 1
    FcgidInitialEnv QGIS_SERVER_LOG_LEVEL 0
    FcgidInitialEnv QGIS_PROJECT_FILE /var/www/qgis/wfml/wfml.qgs
    FcgidInitialEnv QGIS_PLUGINPATH /usr/lib/qgis/plugins
    FcgidIOTimeout 120
    FcgidMaxProcessesPerClass 4

    ErrorLog ${APACHE_LOG_DIR}/qgis-error.log
    CustomLog ${APACHE_LOG_DIR}/qgis-access.log combined
</VirtualHost>
exit_code=0

+ cat /etc/apache2/ports.conf
# If you just change the port or add more ports here, you will likely also
# have to change the VirtualHost statement in
# /etc/apache2/sites-enabled/000-default.conf

Listen 8080

<IfModule ssl_module>
	Listen 443
</IfModule>

<IfModule mod_gnutls.c>
	Listen 443
</IfModule>
exit_code=0


===== APACHE ENABLED SITES =====

+ ls -la /etc/apache2/sites-enabled/
total 8
drwxr-xr-x 2 root root 4096 Feb  9 04:13 .
drwxr-xr-x 8 root root 4096 Feb  9 02:18 ..
lrwxrwxrwx 1 root root   35 Feb  9 02:17 000-default.conf -> ../sites-available/000-default.conf
lrwxrwxrwx 1 root root   35 Feb  9 04:13 qgis-server.conf -> ../sites-available/qgis-server.conf
exit_code=0


===== APACHE MODULES =====

+ apache2ctl -M 2>/dev/null | grep -E 'fcgid|cgi'
 cgid_module (shared)
 fcgid_module (shared)
exit_code=0


===== NGINX TESTPOZI CONFIG =====

+ cat /etc/nginx/sites-available/testpozi.online
server {
    server_name testpozi.online;

    root /var/www/lizmap-web-client-3.9.1/lizmap/www;
    index index.php;

    # pass QGIS Server requests to Apache
    location /cgi-bin/ {
        proxy_pass http://127.0.0.1:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    location / {
        try_files $uri $uri/ =404;
    }

    location ~ [^/]\.php(/|$) {
        fastcgi_split_path_info ^(.+\.php)(/.*)$;
        set $path_info $fastcgi_path_info;
        try_files $fastcgi_script_name =404;
        include fastcgi_params;
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        fastcgi_param PATH_INFO $path_info;
        fastcgi_param PATH_TRANSLATED $document_root$path_info;
        fastcgi_pass unix:/var/run/php/php8.3-fpm.sock;
        fastcgi_param SERVER_NAME $http_host;
    }

    listen 443 ssl; # managed by Certbot
    ssl_certificate /etc/letsencrypt/live/testpozi.online/fullchain.pem; # managed by Certbot
    ssl_certificate_key /etc/letsencrypt/live/testpozi.online/privkey.pem; # managed by Certbot
    include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot

}
server {
    if ($host = testpozi.online) {
        return 301 https://$host$request_uri;
    } # managed by Certbot


    listen 80;
    server_name testpozi.online;
    return 404; # managed by Certbot


}exit_code=0


===== QGIS SERVER PLUGIN =====

+ ls -laR /usr/lib/qgis/plugins/
/usr/lib/qgis/plugins/:
total 12008
drwxr-xr-x 3 root root    4096 Feb  9 04:51 .
drwxr-xr-x 4 root root    4096 Feb  9 04:00 ..
-rw-r--r-- 1 root root  133216 Apr  5  2024 libauthmethod_apiheader.so
-rw-r--r-- 1 root root  133216 Apr  5  2024 libauthmethod_awss3.so
-rw-r--r-- 1 root root  133288 Apr  5  2024 libauthmethod_basic.so
-rw-r--r-- 1 root root   67680 Apr  5  2024 libauthmethod_esritoken.so
-rw-r--r-- 1 root root  133288 Apr  5  2024 libauthmethod_identcert.so
-rw-r--r-- 1 root root   67680 Apr  5  2024 libauthmethod_maptilerhmacsha256.so
-rw-r--r-- 1 root root  133288 Apr  5  2024 libauthmethod_pkcs12.so
-rw-r--r-- 1 root root  133288 Apr  5  2024 libauthmethod_pkipaths.so
-rw-r--r-- 1 root root  592056 Apr  5  2024 libprovider_arcgisfeatureserver.so
-rw-r--r-- 1 root root  264288 Apr  5  2024 libprovider_arcgismapserver.so
-rw-r--r-- 1 root root  395440 Apr  5  2024 libprovider_delimitedtext.so
-rw-r--r-- 1 root root  264296 Apr  5  2024 libprovider_gpx.so
-rw-r--r-- 1 root root 1116304 Apr  5  2024 libprovider_hana.so
-rw-r--r-- 1 root root 1509576 Apr  5  2024 libprovider_mdal.so
-rw-r--r-- 1 root root  854200 Apr  5  2024 libprovider_mssql.so
-rw-r--r-- 1 root root 1378504 Apr  5  2024 libprovider_postgres.so
-rw-r--r-- 1 root root  592064 Apr  5  2024 libprovider_postgresraster.so
-rw-r--r-- 1 root root  788688 Apr  5  2024 libprovider_spatialite.so
-rw-r--r-- 1 root root  395496 Apr  5  2024 libprovider_virtuallayer.so
-rw-r--r-- 1 root root  133216 Apr  5  2024 libprovider_virtualraster.so
-rw-r--r-- 1 root root  460976 Apr  5  2024 libprovider_wcs.so
-rw-r--r-- 1 root root 1378528 Apr  5  2024 libprovider_wfs.so
-rw-r--r-- 1 root root 1181888 Apr  5  2024 libprovider_wms.so
drwxr-xr-x 5 root root    4096 Feb  9 04:51 lizmap_server

/usr/lib/qgis/plugins/lizmap_server:
total 256
drwxr-xr-x 5 root root  4096 Feb  9 04:51 .
drwxr-xr-x 3 root root  4096 Feb  9 04:51 ..
-rw-r--r-- 1 root root 18037 Jan  1  1980 LICENSE
-rwxr-xr-x 1 root root  1383 Jan  1  1980 __init__.py
drwxr-xr-x 2 root root  4096 Feb  9 04:51 context
-rwxr-xr-x 1 root root 11371 Jan  1  1980 core.py
drwxr-xr-x 2 root root  4096 Feb  9 04:51 definitions
-rwxr-xr-x 1 root root  2226 Jan  1  1980 exception.py
-rwxr-xr-x 1 root root 39247 Jan  1  1980 expression_service.py
-rwxr-xr-x 1 root root 18115 Jan  1  1980 filter_by_polygon.py
-rwxr-xr-x 1 root root 12315 Jan  1  1980 get_feature_info.py
-rw-r--r-- 1 root root  9286 Jan  1  1980 get_legend_graphic.py
-rw-r--r-- 1 root root  4823 Jan  1  1980 legend_onoff_filter.py
-rwxr-xr-x 1 root root 19603 Jan  1  1980 lizmap_accesscontrol.py
-rwxr-xr-x 1 root root  3178 Jan  1  1980 lizmap_filter.py
-rwxr-xr-x 1 root root  8265 Jan  1  1980 lizmap_service.py
-rwxr-xr-x 1 root root  2658 Jan  1  1980 logger.py
-rwxr-xr-x 1 root root  1929 Jan  1  1980 metadata.txt
-rw-r--r-- 1 root root  4787 Jan  1  1980 plausible.py
-rwxr-xr-x 1 root root  4265 Jan  1  1980 plugin.py
drwxr-xr-x 3 root root  4096 Feb  9 04:51 resources
-rwxr-xr-x 1 root root  7011 Jan  1  1980 server_info_handler.py
-rwxr-xr-x 1 root root  1936 Jan  1  1980 tools.py
-rwxr-xr-x 1 root root 20734 Jan  1  1980 tooltip.py
-rw-r--r-- 1 root root   631 Jan  1  1980 tos_definitions.py

/usr/lib/qgis/plugins/lizmap_server/context:
total 28
drwxr-xr-x 2 root root 4096 Feb  9 04:51 .
drwxr-xr-x 5 root root 4096 Feb  9 04:51 ..
-rw-r--r-- 1 root root  758 Jan  1  1980 __init__.py
-rw-r--r-- 1 root root 2478 Jan  1  1980 common.py
-rw-r--r-- 1 root root 2651 Jan  1  1980 native.py
-rw-r--r-- 1 root root 3397 Jan  1  1980 py_qgis_server.py
-rw-r--r-- 1 root root 3583 Jan  1  1980 qjazz.py

/usr/lib/qgis/plugins/lizmap_server/definitions:
total 16
drwxr-xr-x 2 root root 4096 Feb  9 04:51 .
drwxr-xr-x 5 root root 4096 Feb  9 04:51 ..
-rw-r--r-- 1 root root   97 Jan  1  1980 __init__.py
-rw-r--r-- 1 root root  343 Jan  1  1980 safe_expressions.py

/usr/lib/qgis/plugins/lizmap_server/resources:
total 12
drwxr-xr-x 3 root root 4096 Feb  9 04:51 .
drwxr-xr-x 5 root root 4096 Feb  9 04:51 ..
drwxr-xr-x 2 root root 4096 Feb  9 04:51 icons

/usr/lib/qgis/plugins/lizmap_server/resources/icons:
total 12
drwxr-xr-x 2 root root 4096 Feb  9 04:51 .
drwxr-xr-x 3 root root 4096 Feb  9 04:51 ..
-rwxr-xr-x 1 root root 1544 Jan  1  1980 icon.png
exit_code=0

+ dpkg -l | grep -i qgis
ii  libqgis-3d3.34.4t64                     3.34.4+dfsg-4build2                     arm64        QGIS - shared 3d library
ii  libqgis-analysis3.34.4t64               3.34.4+dfsg-4build2                     arm64        QGIS - shared analysis library
ii  libqgis-core3.34.4t64                   3.34.4+dfsg-4build2                     arm64        QGIS - shared core library
ii  libqgis-customwidgets                   3.34.4+dfsg-4build2                     arm64        QGIS custom widgets for Qt Designer
ii  libqgis-gui3.34.4t64                    3.34.4+dfsg-4build2                     arm64        QGIS - shared gui library
ii  libqgis-native3.34.4t64                 3.34.4+dfsg-4build2                     arm64        QGIS - shared native gui library
ii  libqgis-server3.34.4t64                 3.34.4+dfsg-4build2                     arm64        QGIS - shared server library
ii  libqgispython3.34.4t64                  3.34.4+dfsg-4build2                     arm64        QGIS - shared Python library
ii  python3-qgis                            3.34.4+dfsg-4build2                     arm64        Python bindings to QGIS
ii  python3-qgis-common                     3.34.4+dfsg-4build2                     all          Python bindings to QGIS - architecture-independent files
ii  qgis-providers                          3.34.4+dfsg-4build2                     arm64        collection of data providers to QGIS
ii  qgis-providers-common                   3.34.4+dfsg-4build2                     all          collection of data providers to QGIS - architecture-independent files
ii  qgis-server                             3.34.4+dfsg-4build2                     arm64        QGIS server providing various OGC services
ii  qgis-server-bin                         3.34.4+dfsg-4build2                     arm64        QGIS server providing various OGC services (executables)
ii  qgis-server-common                      3.34.4+dfsg-4build2                     all          QGIS server providing various OGC services (data)
ii  qgis-server-dummy                       3.34.4+dfsg-4build2                     arm64        QGIS server providing various OGC services (dummy)
ii  qgis-server-landingpage                 3.34.4+dfsg-4build2                     arm64        QGIS server providing various OGC services (landing page)
ii  qgis-server-wcs                         3.34.4+dfsg-4build2                     arm64        QGIS server providing various OGC services (WCS)
ii  qgis-server-wfs                         3.34.4+dfsg-4build2                     arm64        QGIS server providing various OGC services (WFS)
ii  qgis-server-wfs3                        3.34.4+dfsg-4build2                     arm64        QGIS server providing various OGC services (WFS 3)
ii  qgis-server-wms                         3.34.4+dfsg-4build2                     arm64        QGIS server providing various OGC services (WMS)
ii  qgis-server-wmts                        3.34.4+dfsg-4build2                     arm64        QGIS server providing various OGC services (WMTS)
exit_code=0

+ dpkg -l | grep -i python3-qgis
ii  python3-qgis                            3.34.4+dfsg-4build2                     arm64        Python bindings to QGIS
ii  python3-qgis-common                     3.34.4+dfsg-4build2                     all          Python bindings to QGIS - architecture-independent files
exit_code=0


===== QGIS SERVER VERSION =====

+ /usr/lib/cgi-bin/qgis_mapserv.fcgi --version 2>&1 || true
QGIS 3.34.4-Prizren 'Prizren' (exported)
QGIS code branchRelease 3.34
Qt version 5.15.13
Python version 3.12.2
GDAL/OGR version 3.8.4
PROJ version 9.4.0
EPSG Registry database version v11.004 (2024-02-24)
GEOS version 3.12.1-CAPI-1.18.1
SQLite version 3.45.1
OS Ubuntu 24.04.3 LTS
exit_code=0


===== WMS GETCAPABILITIES (direct via Apache) =====

+ wget -qO- 'http://127.0.0.1:8080/cgi-bin/qgis_mapserv.fcgi?SERVICE=WMS&REQUEST=GetCapabilities&MAP=/var/www/qgis/wfml/wfml.qgs' | head -30
<?xml version="1.0" encoding="utf-8"?>
<WMS_Capabilities xmlns="http://www.opengis.net/wms" xmlns:qgs="http://www.qgis.org/wms" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.opengis.net/wms http://schemas.opengis.net/wms/1.3.0/capabilities_1_3_0.xsd http://www.opengis.net/sld http://schemas.opengis.net/sld/1.1.0/sld_capabilities.xsd http://www.qgis.org/wms http://127.0.0.1:8080/cgi-bin/qgis_mapserv.fcgi?MAP=/var/www/qgis/wfml/wfml.qgs&amp;SERVICE=WMS&amp;REQUEST=GetSchemaExtension" version="1.3.0" xmlns:sld="http://www.opengis.net/sld">
 <Service>
  <Name>WMS</Name>
  <Title>WFMA - Wimmera Flood Maps</Title>
  <Abstract><![CDATA[Flood depth rasters for the Wimmera region across multiple study areas and return periods]]></Abstract>
  <KeywordList>
   <Keyword vocabulary="ISO">infoMapAccessService</Keyword>
   <Keyword>flood</Keyword>
   <Keyword>depth</Keyword>
   <Keyword>wimmera</Keyword>
   <Keyword>WCMA</Keyword>
  </KeywordList>
  <OnlineResource xmlns:xlink="http://www.w3.org/1999/xlink" xlink:type="simple" xlink:href="https://wcma.vic.gov.au"/>
  <ContactInformation>
   <ContactPersonPrimary>
    <ContactPerson>Mohammad Arifur Rahman</ContactPerson>
    <ContactOrganization>Wimmera Catchment Management Authority</ContactOrganization>
   </ContactPersonPrimary>
   <ContactPosition>Analyst Programmer</ContactPosition>
   <ContactVoiceTelephone>+61406155493</ContactVoiceTelephone>
   <ContactElectronicMailAddress>gis@wcma.vic.gov.au</ContactElectronicMailAddress>
  </ContactInformation>
  <Fees>conditions unknown</Fees>
  <AccessConstraints>None</AccessConstraints>
 </Service>
 <Capability>
  <Request>
   <GetCapabilities>
    <Format>text/xml</Format>
exit_code=0


===== LIZMAP SERVER PLUGIN ENDPOINT =====

+ wget -qO- 'http://127.0.0.1:8080/cgi-bin/qgis_mapserv.fcgi/lizmap/server.json'
<?xml version="1.0" encoding="UTF-8"?>
<ServiceExceptionReport xmlns="http://www.opengis.net/ogc" version="1.3.0">
 <ServiceException code="Service configuration error">Service unknown or unsupported. Current supported services (case-sensitive): WMS WFS WCS WMTS SampleService, or use a WFS3 (OGC API Features) endpoint</ServiceException>
</ServiceExceptionReport>
exit_code=0

+ wget -qO- 'http://127.0.0.1:8080/cgi-bin/qgis_mapserv.fcgi?SERVICE=LIZMAP&REQUEST=GetServerSettings'
<?xml version="1.0" encoding="UTF-8"?>
<ServiceExceptionReport xmlns="http://www.opengis.net/ogc" version="1.3.0">
 <ServiceException code="Service configuration error">Service unknown or unsupported. Current supported services (case-sensitive): WMS WFS WCS WMTS SampleService, or use a WFS3 (OGC API Features) endpoint</ServiceException>
</ServiceExceptionReport>
exit_code=0


===== QGIS SERVER LOGS =====

+ tail -50 /var/log/apache2/qgis-error.log 2>/dev/null || echo 'no log'
exit_code=0

+ tail -50 /var/log/apache2/qgis-access.log 2>/dev/null | tail -20
127.0.0.1 - - [09/Feb/2026:04:18:16 +0000] "GET / HTTP/1.0" 200 3423 "-" "Mozilla/5.0 (iPhone; CPU iPhone OS 18_7_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) CriOS/143.0.7499.151 Mobile/15E148 Safari/604.1"
127.0.0.1 - - [09/Feb/2026:04:18:17 +0000] "GET /icons/ubuntu-logo.png HTTP/1.0" 200 3571 "https://testpozi.online/" "Mozilla/5.0 (iPhone; CPU iPhone OS 18_7_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) CriOS/143.0.7499.151 Mobile/15E148 Safari/604.1"
127.0.0.1 - - [09/Feb/2026:04:18:19 +0000] "GET /favicon.ico HTTP/1.0" 404 457 "https://testpozi.online/" "Mozilla/5.0 (iPhone; CPU iPhone OS 18_7_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) CriOS/143.0.7499.151 Mobile/15E148 Safari/604.1"
127.0.0.1 - - [09/Feb/2026:04:19:34 +0000] "GET / HTTP/1.0" 200 3423 "-" "Mozilla/5.0 (iPhone; CPU iPhone OS 8_3 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) GSA/5.5.50480 Mobile/12F70 Safari/600.1.4"
127.0.0.1 - - [09/Feb/2026:04:19:35 +0000] "GET / HTTP/1.0" 200 3423 "-" "Mozilla/5.0 (iPhone; CPU iPhone OS 8_3 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) GSA/5.5.50480 Mobile/12F70 Safari/600.1.4"
127.0.0.1 - - [09/Feb/2026:04:19:53 +0000] "HEAD / HTTP/1.0" 200 274 "http://testpozi.online" "Mozilla/5.0 (compatible; Let's Encrypt validation server; +https://www.letsencrypt.org)"
127.0.0.1 - - [09/Feb/2026:04:19:58 +0000] "GET /favicon.ico HTTP/1.0" 404 457 "-" "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36"
127.0.0.1 - - [09/Feb/2026:04:19:59 +0000] "GET / HTTP/1.0" 200 3423 "-" "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36"
127.0.0.1 - - [09/Feb/2026:04:20:00 +0000] "GET /icons/ubuntu-logo.png HTTP/1.0" 200 3571 "https://testpozi.online/" "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36"
127.0.0.1 - - [09/Feb/2026:04:23:23 +0000] "GET / HTTP/1.0" 200 3423 "-" "Mozilla/5.0 (iPhone; CPU iPhone OS 16_6_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.5 Mobile/15E148 Safari/604.1"
127.0.0.1 - - [09/Feb/2026:04:23:23 +0000] "GET /icons/ubuntu-logo.png HTTP/1.0" 200 3571 "https://testpozi.online/" "Mozilla/5.0 (iPhone; CPU iPhone OS 16_6_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.5 Mobile/15E148 Safari/604.1"
127.0.0.1 - - [09/Feb/2026:04:23:24 +0000] "GET /favicon.ico HTTP/1.0" 404 457 "https://testpozi.online/" "Mozilla/5.0 (iPhone; CPU iPhone OS 16_6_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.5 Mobile/15E148 Safari/604.1"
127.0.0.1 - - [09/Feb/2026:04:23:36 +0000] "GET / HTTP/1.0" 200 3423 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36 Edg/144.0.0.0"
127.0.0.1 - - [09/Feb/2026:04:23:36 +0000] "GET /icons/ubuntu-logo.png HTTP/1.0" 200 3571 "https://testpozi.online/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36 Edg/144.0.0.0"
127.0.0.1 - - [09/Feb/2026:04:23:46 +0000] "GET /cgi-bin/qgis_mapserv.fcgi?SERVICE=WMS&REQUEST=GetCapabilities&MAP=/var/www/qgis/wfml/wfml.qgs HTTP/1.0" 200 6711 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36 Edg/144.0.0.0"
127.0.0.1 - - [09/Feb/2026:04:23:57 +0000] "GET / HTTP/1.0" 200 3423 "-" "Mozilla/5.0 (iPhone; CPU iPhone OS 17_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) CriOS/116.0.5845.177 Mobile/15E148 Safari/604.1"
127.0.0.1 - - [09/Feb/2026:04:23:57 +0000] "GET /icons/ubuntu-logo.png HTTP/1.0" 200 3571 "https://testpozi.online/" "Mozilla/5.0 (iPhone; CPU iPhone OS 17_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) CriOS/116.0.5845.177 Mobile/15E148 Safari/604.1"
127.0.0.1 - - [09/Feb/2026:04:23:58 +0000] "GET /favicon.ico HTTP/1.0" 404 457 "https://testpozi.online/" "Mozilla/5.0 (iPhone; CPU iPhone OS 17_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) CriOS/116.0.5845.177 Mobile/15E148 Safari/604.1"
127.0.0.1 - - [09/Feb/2026:04:29:03 +0000] "GET / HTTP/1.0" 200 3423 "-" "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36"
127.0.0.1 - - [09/Feb/2026:04:29:03 +0000] "GET /icons/ubuntu-logo.png HTTP/1.0" 200 3571 "https://testpozi.online/" "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36"
exit_code=0


===== LIZMAP ERROR LOGS =====

+ tail -50 /var/www/lizmap-web-client-3.9.1/lizmap/var/log/errors.log 2>/dev/null || echo 'no log'
no log
exit_code=0

+ tail -30 /var/www/lizmap-web-client-3.9.1/lizmap/var/log/lizmap-admin.log 2>/dev/null || echo 'no log'
no log
exit_code=0


===== PHP-FPM STATUS =====

+ systemctl status php8.3-fpm --no-pager
● php8.3-fpm.service - The PHP 8.3 FastCGI Process Manager
     Loaded: loaded (/usr/lib/systemd/system/php8.3-fpm.service; enabled; preset: enabled)
     Active: active (running) since Mon 2026-02-09 04:42:13 UTC; 21min ago
       Docs: man:php-fpm8.3(8)
    Process: 33006 ExecStartPost=/usr/lib/php/php-fpm-socket-helper install /run/php/php-fpm.sock /etc/php/8.3/fpm/pool.d/www.conf 83 (code=exited, status=0/SUCCESS)
   Main PID: 33003 (php-fpm8.3)
     Status: "Processes active: 0, idle: 2, Requests: 37, slow: 0, Traffic: 0req/sec"
      Tasks: 3 (limit: 9357)
     Memory: 33.6M (peak: 34.2M)
        CPU: 994ms
     CGroup: /system.slice/php8.3-fpm.service
             ├─33003 "php-fpm: master process (/etc/php/8.3/fpm/php-fpm.conf)"
             ├─33004 "php-fpm: pool www"
             └─33005 "php-fpm: pool www"

Feb 09 04:42:13 ip-172-31-42-19 systemd[1]: Starting php8.3-fpm.service - The PHP 8.3 FastCGI Process Manager...
Feb 09 04:42:13 ip-172-31-42-19 systemd[1]: Started php8.3-fpm.service - The PHP 8.3 FastCGI Process Manager.
exit_code=0

+ php -v
PHP 8.3.6 (cli) (built: Jan  7 2026 08:40:32) (NTS)
Copyright (c) The PHP Group
Zend Engine v4.3.6, Copyright (c) Zend Technologies
    with Zend OPcache v8.3.6, Copyright (c), by Zend Technologies
exit_code=0


===== SERVICES STATUS =====

+ systemctl is-active apache2 nginx php8.3-fpm
active
active
active
exit_code=0

+ sudo ss -tlnp | grep -E '80|8080|443'
LISTEN 0      511          0.0.0.0:80        0.0.0.0:*    users:(("nginx",pid=32984,fd=5),("nginx",pid=32983,fd=5),("nginx",pid=32910,fd=5))                                 
LISTEN 0      511          0.0.0.0:443       0.0.0.0:*    users:(("nginx",pid=32984,fd=6),("nginx",pid=32983,fd=6),("nginx",pid=32910,fd=6))                                 
LISTEN 0      511                *:8080            *:*    users:(("apache2",pid=33334,fd=4),("apache2",pid=33333,fd=4),("apache2",pid=33331,fd=4),("apache2",pid=33328,fd=4))
exit_code=0


===== DISK AND MEMORY =====

+ df -h /
Filesystem      Size  Used Avail Use% Mounted on
/dev/root        61G   11G   51G  17% /
exit_code=0

+ free -h
               total        used        free      shared  buff/cache   available
Mem:           7.6Gi       973Mi       192Mi        13Mi       6.7Gi       6.7Gi
Swap:             0B          0B          0B
exit_code=0

===== DONE =====
